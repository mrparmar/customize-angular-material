{"version":3,"file":"progress-bar.js","sources":["../../../src/lib/progress-bar/progress-bar-module.ts","../../../src/lib/progress-bar/progress-bar.ts"],"sourcesContent":["/**\r\n * @license\r\n * Copyright Google LLC All Rights Reserved.\r\n *\r\n * Use of this source code is governed by an MIT-style license that can be\r\n * found in the LICENSE file at https://angular.io/license\r\n */\r\n\r\nimport {NgModule} from '@angular/core';\r\nimport {CommonModule} from '@angular/common';\r\nimport {MatCommonModule} from '@angular/material/core';\r\nimport {MatProgressBar} from './progress-bar';\r\n\r\n\r\n@NgModule({\r\n  imports: [CommonModule, MatCommonModule],\r\n  exports: [MatProgressBar, MatCommonModule],\r\n  declarations: [MatProgressBar],\r\n})\r\nexport class MatProgressBarModule {}\r\n","/**\r\n * @license\r\n * Copyright Google LLC All Rights Reserved.\r\n *\r\n * Use of this source code is governed by an MIT-style license that can be\r\n * found in the LICENSE file at https://angular.io/license\r\n */\r\nimport {\r\n  Component,\r\n  ChangeDetectionStrategy,\r\n  ElementRef,\r\n  Inject,\r\n  Input,\r\n  Output,\r\n  EventEmitter,\r\n  Optional,\r\n  NgZone,\r\n  ViewEncapsulation,\r\n  AfterViewInit,\r\n  ViewChild,\r\n  OnDestroy,\r\n  InjectionToken,\r\n  inject,\r\n} from '@angular/core';\r\nimport {fromEvent, Subscription} from 'rxjs';\r\nimport {filter} from 'rxjs/operators';\r\nimport {ANIMATION_MODULE_TYPE} from '@angular/platform-browser/animations';\r\nimport {CanColor, CanColorCtor, mixinColor} from '@angular/material/core';\r\nimport {DOCUMENT} from '@angular/common';\r\n\r\n// TODO(josephperrott): Benchpress tests.\r\n// TODO(josephperrott): Add ARIA attributes for progress bar \"for\".\r\n\r\n// Boilerplate for applying mixins to MatProgressBar.\r\n/** @docs-private */\r\nexport class MatProgressBarBase {\r\n  constructor(public _elementRef: ElementRef) { }\r\n}\r\n\r\n/** Last animation end data. */\r\nexport interface ProgressAnimationEnd {\r\n  value: number;\r\n}\r\n\r\nexport const _MatProgressBarMixinBase: CanColorCtor & typeof MatProgressBarBase =\r\n    mixinColor(MatProgressBarBase, 'primary');\r\n\r\n/**\r\n * Injection token used to provide the current location to `MatProgressBar`.\r\n * Used to handle server-side rendering and to stub out during unit tests.\r\n * @docs-private\r\n */\r\nexport const MAT_PROGRESS_BAR_LOCATION = new InjectionToken<MatProgressBarLocation>(\r\n  'mat-progress-bar-location',\r\n  {providedIn: 'root', factory: MAT_PROGRESS_BAR_LOCATION_FACTORY}\r\n);\r\n\r\n/**\r\n * Stubbed out location for `MatProgressBar`.\r\n * @docs-private\r\n */\r\nexport interface MatProgressBarLocation {\r\n  getPathname: () => string;\r\n}\r\n\r\n/** @docs-private */\r\nexport function MAT_PROGRESS_BAR_LOCATION_FACTORY(): MatProgressBarLocation {\r\n  const _document = inject(DOCUMENT);\r\n  const _location = _document ? _document.location : null;\r\n\r\n  return {\r\n    // Note that this needs to be a function, rather than a property, because Angular\r\n    // will only resolve it once, but we want the current path on each call.\r\n    getPathname: () => _location ? (_location.pathname + _location.search) : ''\r\n  };\r\n}\r\n\r\n\r\n/** Counter used to generate unique IDs for progress bars. */\r\nlet progressbarId = 0;\r\n\r\n/**\r\n * `<mat-progress-bar>` component.\r\n */\r\n@Component({\r\n  moduleId: module.id,\r\n  selector: 'mat-progress-bar',\r\n  exportAs: 'matProgressBar',\r\n  host: {\r\n    'role': 'progressbar',\r\n    'aria-valuemin': '0',\r\n    'aria-valuemax': '100',\r\n    '[attr.aria-valuenow]': 'value',\r\n    '[attr.mode]': 'mode',\r\n    'class': 'mat-progress-bar',\r\n    '[class._mat-animation-noopable]': `_isNoopAnimation`,\r\n  },\r\n  inputs: ['color'],\r\n  templateUrl: 'progress-bar.html',\r\n  styleUrls: ['progress-bar.css'],\r\n  changeDetection: ChangeDetectionStrategy.OnPush,\r\n  encapsulation: ViewEncapsulation.None,\r\n})\r\nexport class MatProgressBar extends _MatProgressBarMixinBase implements CanColor,\r\n                                                      AfterViewInit, OnDestroy {\r\n  constructor(public _elementRef: ElementRef, private _ngZone: NgZone,\r\n              @Optional() @Inject(ANIMATION_MODULE_TYPE) public _animationMode?: string,\r\n              /**\r\n               * @deprecated `location` parameter to be made required.\r\n               * @breaking-change 8.0.0\r\n               */\r\n              @Optional() @Inject(MAT_PROGRESS_BAR_LOCATION) location?: MatProgressBarLocation) {\r\n    super(_elementRef);\r\n\r\n    // We need to prefix the SVG reference with the current path, otherwise they won't work\r\n    // in Safari if the page has a `<base>` tag. Note that we need quotes inside the `url()`,\r\n\r\n    // because named route URLs can contain parentheses (see #12338). Also we don't use since\r\n    // we can't tell the difference between whether\r\n    // the consumer is using the hash location strategy or not, because `Location` normalizes\r\n    // both `/#/foo/bar` and `/foo/bar` to the same thing.\r\n    const path = location ? location.getPathname().split('#')[0] : '';\r\n    this._rectangleFillValue = `url('${path}#${this.progressbarId}')`;\r\n    this._isNoopAnimation = _animationMode === 'NoopAnimations';\r\n  }\r\n\r\n  /** Flag that indicates whether NoopAnimations mode is set to true. */\r\n  _isNoopAnimation = false;\r\n\r\n  /** Value of the progress bar. Defaults to zero. Mirrored to aria-valuenow. */\r\n  @Input()\r\n  get value(): number { return this._value; }\r\n  set value(v: number) {\r\n    this._value = clamp(v || 0);\r\n\r\n    // When noop animation is set to true, trigger animationEnd directly.\r\n    if (this._isNoopAnimation) {\r\n      this.emitAnimationEnd();\r\n    }\r\n  }\r\n  private _value: number = 0;\r\n\r\n  /** Buffer value of the progress bar. Defaults to zero. */\r\n  @Input()\r\n  get bufferValue(): number { return this._bufferValue; }\r\n  set bufferValue(v: number) { this._bufferValue = clamp(v || 0); }\r\n  private _bufferValue: number = 0;\r\n\r\n  @ViewChild('primaryValueBar') _primaryValueBar: ElementRef;\r\n\r\n  /**\r\n   * Event emitted when animation of the primary progress bar completes. This event will not\r\n   * be emitted when animations are disabled, nor will it be emitted for modes with continuous\r\n   * animations (indeterminate and query).\r\n   */\r\n  @Output() animationEnd = new EventEmitter<ProgressAnimationEnd>();\r\n\r\n  /** Reference to animation end subscription to be unsubscribed on destroy. */\r\n  private _animationEndSubscription: Subscription = Subscription.EMPTY;\r\n\r\n  /**\r\n   * Mode of the progress bar.\r\n   *\r\n   * Input must be one of these values: determinate, indeterminate, buffer, query, defaults to\r\n   * 'determinate'.\r\n   * Mirrored to mode attribute.\r\n   */\r\n  @Input() mode: 'determinate' | 'indeterminate' | 'buffer' | 'query' = 'determinate';\r\n\r\n  /** ID of the progress bar. */\r\n  progressbarId = `mat-progress-bar-${progressbarId++}`;\r\n\r\n  /** Attribute to be used for the `fill` attribute on the internal `rect` element. */\r\n  _rectangleFillValue: string;\r\n\r\n  /** Gets the current transform value for the progress bar's primary indicator. */\r\n  _primaryTransform() {\r\n    const scale = this.value / 100;\r\n    return {transform: `scaleX(${scale})`};\r\n  }\r\n\r\n  /**\r\n   * Gets the current transform value for the progress bar's buffer indicator. Only used if the\r\n   * progress mode is set to buffer, otherwise returns an undefined, causing no transformation.\r\n   */\r\n  _bufferTransform() {\r\n    if (this.mode === 'buffer') {\r\n      const scale = this.bufferValue / 100;\r\n      return {transform: `scaleX(${scale})`};\r\n    }\r\n  }\r\n\r\n  ngAfterViewInit() {\r\n    if (!this._isNoopAnimation) {\r\n      // Run outside angular so change detection didn't get triggered on every transition end\r\n      // instead only on the animation that we care about (primary value bar's transitionend)\r\n      this._ngZone.runOutsideAngular((() => {\r\n        this._animationEndSubscription =\r\n            fromEvent<TransitionEvent>(this._primaryValueBar.nativeElement, 'transitionend')\r\n            .pipe(filter(((e: TransitionEvent) =>\r\n              e.target === this._primaryValueBar.nativeElement)))\r\n            .subscribe(_ => this._ngZone.run(() => this.emitAnimationEnd()));\r\n      }));\r\n    }\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    this._animationEndSubscription.unsubscribe();\r\n  }\r\n\r\n  /** Emit an animationEnd event if in determinate or buffer mode. */\r\n  private emitAnimationEnd(): void {\r\n    if (this.mode === 'determinate' || this.mode === 'buffer') {\r\n      this.animationEnd.next({value: this.value});\r\n    }\r\n  }\r\n}\r\n\r\n/** Clamps a value to be between two numbers, by default 0 and 100. */\r\nfunction clamp(v: number, min = 0, max = 100) {\r\n  return Math.max(min, Math.min(max, v));\r\n}\r\n"],"names":[],"mappings":"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"}